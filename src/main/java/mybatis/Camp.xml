<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="camp">

<insert id="CampInsert" parameterType="camp">
insert into camp values(
#{campidx}, #{campname}, #{campaddr}, #{room}, 
#{campimg}, #{campimg2}, #{campimg3}, #{roomcnt}, #{payidx}, #{roomno},
#{chkin}, #{chkout}, #{content})
</insert>

<delete id="campDelete" parameterType="int">
delete from camp where campidx = #{campidx}
</delete>

<update id="CampUpdate" parameterType="camp">
update camp set
campname=#{campname}, campaddr = #{campaddr}, room = #{room}, campimg = #{campimg}, campimg2 = #{campimg2}, campimg3 = #{campimg3}, 
roomcnt = #{roomcnt}, payidx = #{payidx}, roomno = #{roomno} 
where campidx = #{campidx}
</update>

<select id="selectCamp" resultType="camp" parameterType="int">
select * from camp where campidx = #{campidx}
</select>

<select id="chooseCamp" resultType="camp" parameterType="String">
select campname, campaddr, room, campimg, payidx 
from camp where campname = #{campname}
</select>

<select id="nextSeq" resultType="int">
select seqcamp.nextval from dual
</select>

<select id="CampList"  resultType="camp">
select campname, campaddr, 
room, campimg, payidx, content
from camp order by campidx desc
</select>

<select id="SearchList" resultType="camp" parameterType="map">
select * from camp
	<if test="searchType == 1"> 
			 where campaddr like '%${searchName}%'
</if>
	<if test="searchType == 2">
			where room like '%${searchName}%'
</if>
</select>

<select id="CampInfo"  resultType="camp"  parameterType="String">
select campimg, campimg2, campimg3, campname, campaddr, 
room,  payidx, chkin, chkout, content
from camp where campname = #{campname}
</select>

<select id="RoomList"  resultType="camp" parameterType="String">
select room from camp where campname=#{campname}
</select>
<select id="blackList" parameterType="string" resultType="userdata">
	select*from userdata where black=#{black}
</select>
<select id ="campListAll" resultType="camp">
select *  from camp  
</select>
<select id ="reserveList" resultType="reserve">
select *  from reserve  
</select>

<select id="reserveListAll" resultType="reserve">
select r.*, c.* from reserve r, camp c   where r.campname = c.campname
</select>

<select id="monthReserve" resultType="map" >
    select 
    (select count(*) from reserve where to_char(checkin, 'mm')=to_char(sysdate, 'mm'))  p11,
   
    (select count(*) from reserve where to_char(checkin, 'mm')=to_char(sysdate, 'mm')-1)  p12,
    
     (select count(*) from reserve where to_char(checkin, 'yymmdd') = to_char(sysdate, 'yymmdd')) p21,
       (select count(*) from reserve where to_char(checkin, 'yymmdd') = to_char(sysdate+1, 'yymmdd')) p22,
   
     (select sum(payidx) from reserve where to_char(checkin, 'mm') = to_char(sysdate, 'mm')) p31,
    
     (select nvl(sum(payidx), 0) from reserve where to_char(checkin, 'yymmdd') = to_char(sysdate, 'yymmdd')) p32
     
     from dual
     
</select>
<select id="dashboard1" resultType="indexmap">
select to_char(checkin, 'dd') co1, sum(PERSON+KID) co2 from reserve where to_char(checkin, 'mm')=to_char(sysdate, 'mm') GROUP BY to_char(checkin, 'dd')
</select>
<select id="dashboard2" resultType="indexmap">
select to_char(checkin, 'dd') co1, sum(payidx) co2 from reserve where to_char(checkin, 'mm')=to_char(sysdate, 'mm') GROUP BY to_char(checkin, 'dd')
</select>
</mapper>
